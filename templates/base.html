
<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#0d6efd">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<link rel="manifest" href="/static/manifest.json">
<link rel="apple-touch-icon" href="/static/icons/icon-192.png">  
<title>Quermesse Online</title>
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-primary">
  <div class="container-fluid">
    <span class="navbar-brand">Quermesse Online - Comunidade SFA</span>
{% if session.get('usuario') %}
    <a href="/logout" class="btn btn-danger">Sair</a>
{% endif %}
  </div>
</nav>

<div class="container mt-4">

{% with messages = get_flashed_messages(with_categories=true) %}
  {% for category, message in messages %}
    <div class="alert alert-{{category}}">{{ message }}</div>
  {% endfor %}
{% endwith %}

{% block content %}{% endblock %}
</div>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/static/sw.js")
    .then(() => console.log("Service Worker registrado"));
}
</script>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js')
    .then(reg => {

      reg.addEventListener('updatefound', () => {
        const newWorker = reg.installing;

        newWorker.addEventListener('statechange', () => {
          if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {

            if (confirm("Nova versão disponível. Atualizar agora?")) {
              newWorker.postMessage("SKIP_WAITING");
              window.location.reload();
            }
          }
        });
      });

    });
}
</script>
  
</body>
</html>

